library(lme4)
install.packages(lme4)
install.packages('lme4')
library(lme4)
Dyestuff
df <- Dyestuff
View(df)
str(df)
library(ggplot2)
ggplot(df, aes(x=Batch,y=Yield)) +
geom_point()
ggplot(df, aes(x=Batch,y=Yield)) +
geom_boxplot()
ggplot(df, aes(x=Batch,y=Yield)) +
geom_boxplot() +
geom_point()
ggplot(df, aes(x=Batch,y=Yield)) +
geom_boxplot() +
geom_jitter()
ggplot(df, aes(x=Batch,y=Yield)) +
geom_boxplot() +
geom_point()
str(df)
summary(df)
library(ggplot2)
setwd("../data/")
setwd(".")
setwd("../data/")
setwd("~/Desktop/mixed-model-book-prices/data")
df <- read.table("clustered_estc_price_data.txt",
sep="\t",
quote='"',
fill=NA,
na.strings='NULL',
colClasses = c('character','numeric','character','numeric','character', 'numeric',
rep('character',3), rep('numeric',3), rep('character',2), rep('numeric',3), 'character')
)
colnames(df) <- c("estc_id","year","raw_size","clean_size","raw_pages","clean_pages","notes","raw_price","parsed_price","farthings","illustrations","farthings_per_page","author","title","ignore","cluster","unique_years_in_cluster","canonical_title")
str(df)
ggplot(subset(df, cluster !is.na),
aes(x=farthings_per_page, y=farthings_per_page)) +
geom_point()
ggplot(subset(df, cluster !is.na), aes(x=farthings_per_page, y=farthings_per_page)) +
ggplot(subset(df, !is.na(cluster)), aes(x=farthings_per_page, y=farthings_per_page)) +
geom_point()
ggplot(subset(df, !is.na(cluster)), aes(x=cluster, y=farthings_per_page)) +
geom_point()
View(df)
ggplot(subset(df, !is.na(cluster) & cluster < 101), aes(x=cluster, y=farthings_per_page)) +
geom_point()
ggplot(subset(df, !is.na(cluster) & cluster < 101), aes(x=as.factor(cluster), y=farthings_per_page)) +
geom_point()
View(df)
ggplot(subset(df, !is.na(cluster) & cluster < 101), aes(x=as.factor(canonical_title), y=farthings_per_page)) +
geom_point()
ggplot(subset(df, !is.na(cluster) & cluster < 101), aes(x=canonical_title, y=farthings_per_page)) +
geom_point()
ggplot(subset(df, !is.na(cluster) & cluster < 101), aes(x=canonical_title, y=farthings_per_page)) +
geom_point() +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
View(df)
df$short_title <- paste(substr(df$canonical_title, 0:40), "...")
df$short_title <- paste(substr(df$canonical_title, 0, 40), "...")
View(df)
ggplot(subset(df, !is.na(cluster) & cluster < 101), aes(x=short_title, y=farthings_per_page)) +
geom_point() +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
df$short_title <- paste(substr(df$canonical_title, 0, 30), "...")
ggplot(subset(df, !is.na(cluster) & cluster < 101), aes(x=short_title, y=farthings_per_page)) +
geom_point() +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(subset(df, !is.na(cluster) & cluster < 101), aes(x=short_title, y=farthings_per_page)) +
geom_jitter() +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(subset(df, !is.na(cluster) & cluster < 101), aes(x=short_title, y=farthings_per_page)) +
geom_jitter() +
geom_boxplot() +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(subset(df, !is.na(cluster) & cluster < 101), aes(x=short_title, y=farthings_per_page, colour=short_title)) +
geom_jitter() +
geom_boxplot() +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(subset(df, !is.na(cluster) & cluster < 101), aes(x=short_title, y=farthings_per_page)) +
geom_jitter() +
geom_boxplot(colour=short_title) +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(subset(df, !is.na(cluster) & cluster < 101), aes(x=short_title, y=farthings_per_page)) +
geom_jitter() +
geom_boxplot(colour=df$short_title) +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(subset(df, !is.na(cluster) & cluster < 101), aes(x=short_title, y=farthings_per_page)) +
geom_jitter(colour=short_title) +
geom_boxplot() +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(subset(df, !is.na(cluster) & cluster < 101), aes(x=short_title, y=farthings_per_page)) +
geom_jitter() +
geom_boxplot() +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(subset(df, !is.na(cluster) & cluster < 101), aes(x=short_title, y=farthings_per_page)) +
geom_jitter() +
#geom_boxplot() +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(subset(df, !is.na(cluster) & cluster < 201), aes(x=short_title, y=farthings_per_page)) +
geom_jitter() +
#geom_boxplot() +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(subset(df, !is.na(cluster) & cluster < 150), aes(x=short_title, y=farthings_per_page)) +
geom_jitter() +
#geom_boxplot() +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(subset(df, !is.na(cluster) & cluster < 150), aes(x=short_title, y=farthings_per_page, colour=cluster)) +
#geom_jitter() +
geom_boxplot() +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(subset(df, !is.na(cluster) & cluster < 150), aes(x=short_title, y=farthings_per_page, colour=as.factor(cluster))) +
#geom_jitter() +
geom_boxplot() +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
ggplot(subset(df, !is.na(cluster) & cluster < 150), aes(x=short_title, y=farthings_per_page, colour=as.factor(cluster))) +
#geom_jitter() +
geom_boxplot() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
scale_colour_discrete(guide = FALSE)
ggplot(subset(df, !is.na(cluster) & cluster < 250), aes(x=short_title, y=farthings_per_page, colour=as.factor(cluster))) +
#geom_jitter() +
geom_boxplot() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
scale_colour_discrete(guide = FALSE)
ggplot(subset(df, !is.na(cluster) & cluster < 200), aes(x=short_title, y=farthings_per_page, colour=as.factor(cluster))) +
#geom_jitter() +
geom_boxplot() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
scale_colour_discrete(guide = FALSE)
ggplot(subset(df, !is.na(cluster) & cluster < 175), aes(x=short_title, y=farthings_per_page, colour=as.factor(cluster))) +
#geom_jitter() +
geom_boxplot() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
scale_colour_discrete(guide = FALSE)
ggplot(subset(df, !is.na(cluster) & cluster < 160), aes(x=short_title, y=farthings_per_page, colour=as.factor(cluster))) +
#geom_jitter() +
geom_boxplot() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
scale_colour_discrete(guide = FALSE)
ggplot(subset(df, !is.na(cluster) & cluster < 160),
aes(x=short_title, y=farthings_per_page,
colour=as.factor(cluster))) +
#geom_jitter() +
geom_boxplot() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
scale_colour_discrete(guide = FALSE) +
xlab("") +
ylab("Farthings Per Page") +
ggtitle("Early Modern English Book Price Variance")
for(i in df$cluster_prices){
print i
}
for (i in levels(df$cluster)) print(i)
for (i in levels(df$cluster)){
print(i)
}
View(df)
df$cost_median_index <- order(as.numeric(by(df$farthings_per_page, df$cluster, median)))
cost_median_index <- order(as.numeric(by(df$farthings_per_page, df$cluster, median)))
str(cost_median_index)
set.seed(42)                     # fix seed
DF <- data.frame(type=sample(LETTERS[1:5], 100, replace=TRUE),
+                  cost=rnorm(100))
DF <- data.frame(type=sample(LETTERS[1:5], 100, replace=TRUE), cost=rnorm(100))
boxplot(cost ~ type, data=DF)    # not ordered by median
View(DF)
df$cost_median_index <- ordered(df$cluster, levels=levels(df$cluster)[cost_median_index])
ggplot(subset(df, !is.na(cluster) & cluster < 160),
aes(x=short_title, y=farthings_per_page,
colour=as.factor(cluster))) +
#geom_jitter() +
geom_boxplot() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
scale_colour_discrete(guide = FALSE) +
xlab("") +
ylab("Farthings Per Page") +
ggtitle("Early Modern English Book Price Variance")
View(df)
df$short_title <- with(df, reorder(short_title, farthings_per_page, mean))
ggplot(subset(df, !is.na(cluster) & cluster < 160),
aes(x=short_title, y=farthings_per_page,
colour=as.factor(cluster))) +
#geom_jitter() +
geom_boxplot() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
scale_colour_discrete(guide = FALSE) +
xlab("") +
ylab("Farthings Per Page") +
ggtitle("Early Modern English Book Price Variance")
df$short_title <- with(df, reorder(short_title, farthings_per_page, median))
ggplot(subset(df, !is.na(cluster) & cluster < 160),
aes(x=short_title, y=farthings_per_page,
colour=as.factor(cluster))) +
#geom_jitter() +
geom_boxplot() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
scale_colour_discrete(guide = FALSE) +
xlab("") +
ylab("Farthings Per Page") +
ggtitle("Early Modern English Book Price Variance")
ggplot(subset(df, !is.na(cluster) & cluster < 400),
aes(x=short_title, y=farthings_per_page,
colour=as.factor(cluster))) +
#geom_jitter() +
geom_boxplot() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
scale_colour_discrete(guide = FALSE) +
xlab("") +
ylab("Farthings Per Page") +
ggtitle("Early Modern English Book Price Variance")
ggplot(subset(df, !is.na(cluster) & cluster < 250),
aes(x=short_title, y=farthings_per_page,
colour=as.factor(cluster))) +
#geom_jitter() +
geom_boxplot() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
scale_colour_discrete(guide = FALSE) +
xlab("") +
ylab("Farthings Per Page") +
ggtitle("Early Modern English Book Price Variance")
ggplot(subset(df, !is.na(cluster) & cluster < 200),
aes(x=short_title, y=farthings_per_page,
colour=as.factor(cluster))) +
#geom_jitter() +
geom_boxplot() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
scale_colour_discrete(guide = FALSE) +
xlab("") +
ylab("Farthings Per Page") +
ggtitle("Early Modern English Book Price Variance")
p <- ggplot(subset(df, !is.na(cluster) & cluster < 200),
aes(x=short_title, y=farthings_per_page,
colour=as.factor(cluster))) +
#geom_jitter() +
geom_boxplot() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
scale_colour_discrete(guide = FALSE) +
xlab("") +
ylab("Farthings Per Page") +
ggtitle("Early Modern English Book Price Variance")
ggsave(p, file="price_variance.png")
install.packages('lme4')
install.packages("lme4")
library(lme4)
library(ggplot2)
df <- Dyestuff2
View(df)
str(df)
View(df)
fm01 <- lmer(Yield ~ 1 + (1|Batch), df)
print(fm01)
df <- Dyestuff2
fm01 <- lmer(Yield ~ 1 + (1|Batch), df)
print(fm01)
fm01 <- lmer(Yield ~ 1 + (1|Batch), Dyestuff)
print(fm01)
fm01 <- lmer(Yield ~ 1 + (1|Batch), Dyestuff)
print(fm01)
fm01 <- lmer(Yield ~ 1 + (1|Batch), Dyestuff)
print(fm01)
fm01 <- lmer(Yield ~ 1 + (1|Batch), Dyestuff)
print(fm01)
fm01 <- lmer(Yield ~ 1 + (1|Batch), Dyestuff)
print(fm01)
fm01 <- lmer(Yield ~ 1 + (1|Batch), Dyestuff, REML=FALSE)
print(fm01)
ggplot(df, aes(x=Batch,y=Yield)) +
geom_boxplot() +
geom_point()
# Using REML=FALSE uses Maximum Likelihood Estimation
fm01 <- lmer(Yield ~ 1 + (1|Batch), Dyestuff, REML=FALSE)
print(fm01)
ggplot(Dyestuff, aes(x=Batch,y=Yield)) +
geom_boxplot() +
geom_point()
# Using REML=FALSE uses Maximum Likelihood Estimation
fm01 <- lmer(Yield ~ 1 + (1|Batch), Dyestuff, REML=FALSE)
print(fm01)
ggplot(Dyestuff, aes(x=Batch,y=Yield)) +
geom_boxplot() +
geom_point()
# Using REML=FALSE uses Maximum Likelihood Estimation
fm01 <- lmer(Yield ~ 1 + (1|Batch), Dyestuff, REML=FALSE)
print(fm01)
fm01 <- lmer(Yield ~ 1 + (1|Batch), Dyestuff))
fm01 <- lmer(Yield ~ 1 + (1|Batch), Dyestuff)
print(fm01)
(fm01ML <- lmer(Yield ~ 1 + (1|Batch), Dyestuff, REML=FALSE))
ggplot(Dyestuff2, aes(x=Batch,y=Yield)) +
geom_boxplot() +
geom_point()
(fm01ML <- lmer(Yield ~ 1 + (1|Batch), Dyestuff2, REML=FALSE))
lm(Yield ~ 1, Dyestuff2)
?glm
df <- read.table("clustered_estc_price_data.txt",
sep="\t",
quote='"',
fill=NA,
na.strings='NULL',
colClasses = c('character','numeric','character','numeric','character', 'numeric',
rep('character',3), rep('numeric',3), rep('character',2), rep('numeric',3), 'character')
)
# Provide column headers
colnames(df) <- c("estc_id","year","raw_size","clean_size","raw_pages","clean_pages","notes","raw_price","parsed_price","farthings","illustrations","farthings_per_page","author","title","ignore","cluster","unique_years_in_cluster","canonical_title")
ggplot(df, aes(x=farthings_per_page)) +
geom_density()
ggplot(subset(df, clean_pages>30), aes(x=farthings_per_page)) +
geom_density()
ggplot(subset(df, clean_pages>30), aes(x=farthings_per_page)) +
geom_density()
ggplot(subset(df, clean_pages>50), aes(x=farthings_per_page)) +
geom_density()
nrow(df, farthings_per_page > 20)
nrow(subset(df, farthings_per_page > 20))
subset(df, farthings_per_page > 20)
a<-subset(df, farthings_per_page > 20)
a$clean_pages
ggplot(subset(df, clean_pages>50), aes(x=farthings_per_page)) +
geom_density() +
facet_wrap(~clean_size)
ggplot(subset(df, farthings_per_page<10), aes(x=farthings_per_page)) +
geom_density() +
facet_wrap(~clean_size)
a
a$farthings
View(a)
ggplot(subset(df, farthings_per_page<10), aes(x=farthings_per_page)) +
geom_density() +
facet_wrap(~clean_size)
nrow(subset(df, farthings_per_page>5))
nrow(df)
119/18284
ggplot(subset(df, farthings_per_page<5), aes(x=farthings_per_page)) +
geom_density() +
facet_wrap(~clean_size)
ggplot(subset(df, farthings_per_page<5), aes(x=farthings_per_page)) +
geom_density() +
geom_point()
facet_wrap(~clean_size)
ggplot(subset(df, farthings_per_page<5), aes(x=farthings_per_page)) +
geom_density() +
facet_wrap(~clean_size)
ggplot(subset(df, farthings_per_page<5), aes(x=farthings_per_page)) +
geom_histogram() +
facet_wrap(~clean_size)
ggplot(subset(df, farthings_per_page<5), aes(x=farthings_per_page)) +
geom_histogram(binwidth=.1) +
facet_wrap(~clean_size)
ggplot(subset(df, farthings_per_page<5), aes(x=farthings_per_page)) +
geom_histogram(binwidth=.2) +
facet_wrap(~clean_size)
ggplot(subset(df, farthings_per_page<3), aes(x=farthings_per_page)) +
geom_histogram(binwidth=.2) +
facet_wrap(~clean_size)
ggplot(subset(df, farthings_per_page<2), aes(x=farthings_per_page)) +
geom_histogram(binwidth=.2) +
facet_wrap(~clean_size)
ggplot(subset(df, farthings_per_page<3), aes(x=farthings_per_page)) +
geom_histogram(binwidth=.2) +
facet_wrap(~clean_size)
ggplot(subset(df, farthings_per_page<5), aes(x=farthings_per_page)) +
geom_histogram(binwidth=.2) +
facet_wrap(~clean_size)
View(df)
ggplot(subset(df, farthings_per_page<5 & clean_size %in% c('4','8','12')), aes(x=farthings_per_page)) +
geom_histogram(binwidth=.2) +
facet_wrap(~clean_size)
View(df)
# Shorten title for display purposes
df$title_to_plot <- paste( substr(df$canonical_title,0,15), "..." )
# Plot all instances of each book as a unique facet
p <- ggplot(subset(df, unique_years_in_cluster > 2), aes(x=year,y=farthings_per_page, colour=as.factor(cluster))) +
geom_point() +
stat_smooth(method="lm") +
facet_wrap(~title_to_plot, ncol=10) +
scale_x_continuous() +
scale_y_continuous(limits=c(0,3)) +
scale_colour_discrete(guide=FALSE)
p
View(df)
ggsave(p, file="book_facets.png", scale=3)
View(df)
nrow(subset(df, unique_years_in_cluster > 2))
p <- ggplot( subset(n_mean_sd_by_size, !is.na(size)), aes(x=year, y=mean, color=size) ) +
geom_point() +
geom_smooth() +
#geom_errorbar( aes(ymin=mean-sd, ymax=mean+sd), width=.1) +
scale_x_continuous(limits=c(1700, 1800)) +
facet_wrap(~size, scales="free_y", ncol=1) +
ylab("Mean Farthings Per Page") +
xlab("Year") +
ggtitle("Mean Farthings Per Page of English Volumes Within the ESTC") +
guides(color=FALSE)   # this masks the whole key
# Save the plot
ggsave(p, file="farthings_per_page_by_size.png", scale=1.2)
# Calculate number of estc ids per condition (clean_size*year)
n_mean_sd_by_size<- aggregate(df["estc_id"], by=df[c("clean_size","year")], FUN=length)
# Change colname of the number of estc ids per condition to "N"
names(n_mean_sd_by_size)[names(n_mean_sd_by_size)=="estc_id"] <- "N"
# Calculate mean price of books for each size and year combination
mean_by_size.df <- aggregate(farthings_per_page ~ year + clean_size, data = subset(df, clean_pages > 20 ), FUN = 'mean')
# Change colname of the mean price per size and year combination
names(mean_by_size.df)[names(mean_by_size.df)=="farthings_per_page"] <- "mean"
# Merge the dataframes
n_mean_sd_by_size <- merge(n_mean_sd_by_size, mean_by_size.df)
# Get the sample (n-1) standard deviation for farthings_per_page ~ each size and year combination
sd_by_size.df <- aggregate(farthings_per_page ~ year + clean_size, data = subset(df, clean_pages > 20 ), FUN = 'sd')
# Change the colname of the sd per size and year combination
names(sd_by_size.df)[names(sd_by_size.df)=="farthings_per_page"] <- "sd"
# Merge the sd into n_mean_sd_by_size
n_mean_sd_by_size <- merge(n_mean_sd_by_size, sd_by_size.df)
# Retrieve wage data from Wrigley and Schofield
wage_data.df <- read.table('wrigley_schofield_six_forty_farthings.txt')
# Rename wage data columns (use colheaders of good_sizes for easy dataframe concatenation)
colnames(wage_data.df) <- c("year", "clean_size", "mean")
# Take the subset of the wage data pertaining to years 1700-1800
wage_data.df <- subset(wage_data.df, 1699 < year & year < 1801)
# Append fill values for wage data df
wage_data.df$N <- NA
wage_data.df$sd <- NA
# Merge wage data with book price stats
n_mean_sd_by_size <- rbind(n_mean_sd_by_size, wage_data.df)
# Rename book sizes for clarity
n_mean_sd_by_size$size[ n_mean_sd_by_size$clean_size == 4 ] <- 'quarto'
n_mean_sd_by_size$size[ n_mean_sd_by_size$clean_size == 8 ] <- 'octavo'
n_mean_sd_by_size$size[ n_mean_sd_by_size$clean_size == 12 ] <- 'duodecimo'
n_mean_sd_by_size$size[ n_mean_sd_by_size$clean_size == 'labour' ] <- 'wrigley labour estimate'
# Plot the aggregated df
p <- ggplot( subset(n_mean_sd_by_size, !is.na(size)), aes(x=year, y=mean, color=size) ) +
geom_point() +
geom_smooth() +
#geom_errorbar( aes(ymin=mean-sd, ymax=mean+sd), width=.1) +
scale_x_continuous(limits=c(1700, 1800)) +
facet_wrap(~size, scales="free_y", ncol=1) +
ylab("Mean Farthings Per Page") +
xlab("Year") +
ggtitle("Mean Farthings Per Page of English Volumes Within the ESTC") +
guides(color=FALSE)   # this masks the whole key
# Save the plot
ggsave(p, file="farthings_per_page_by_size.png", scale=1.2)
pitch = c(233,204,242,130,112,142)
sex = c(rep("female",3),rep("male",3))
pitch = c(233,204,242,130,112,142)
sex = c(rep("female",3),rep("male",3))
my.df = data.frame(sex,pitch)
ggplot(my.df, aex(x=gender,y=pitch)) +
geom_point()
ggplot(my.df, aes(x=gender,y=pitch)) +
geom_point()
View(my.df)
ggplot(my.df, aes(x=sex, y=pitch)) +
geom_point()
lm(pitch ~ gender)
lm(pitch ~ sex)
(lm(pitch ~ sex))
(lm(pitch ~ sex, df))
(lm(pitch ~ sex, my.df))
summary(lm(pitch ~ sex, my.df))
mean(my.df$sex)
mean(my.df$hertz)
mean(my.df$pitch)
mean(subset(my.df, sex==female)$pitch)
mean(subset(my.df, sex=='female')$pitch)
mean(subset(my.df, sex=='female')$pitch) -98
